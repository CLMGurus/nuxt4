{"version":3,"file":"modes_segmentation_src_index_tsx.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;AAEA;AACA;AAEA;AAEA;AAWA;AAKA;AAIA;AAQA;AAMA;AAIA;AAaA;AAIA;AAKA;AAMA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzOA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAGA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AAIA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpNA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAEA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAGA","sources":["file:////home/balasakthi/Downloads/Viewers-master/modes/segmentation/src/id.js","file:////home/balasakthi/Downloads/Viewers-master/modes/segmentation/src/index.tsx","file:////home/balasakthi/Downloads/Viewers-master/modes/segmentation/src/initToolGroups.ts","file:////home/balasakthi/Downloads/Viewers-master/modes/segmentation/src/toolbarButtons.ts"],"sourcesContent":["import packageJson from '../package.json';\n\nconst id = packageJson.name;\n\nexport { id };\n","import { id } from './id';\nimport toolbarButtons from './toolbarButtons';\nimport initToolGroups from './initToolGroups';\n\nconst ohif = {\n  layout: '@ohif/extension-default.layoutTemplateModule.viewerLayout',\n  sopClassHandler: '@ohif/extension-default.sopClassHandlerModule.stack',\n  hangingProtocol: '@ohif/extension-default.hangingProtocolModule.default',\n  leftPanel: '@ohif/extension-default.panelModule.seriesList',\n};\n\nconst cornerstone = {\n  viewport: '@ohif/extension-cornerstone.viewportModule.cornerstone',\n  panelTool: '@ohif/extension-cornerstone.panelModule.panelSegmentationWithTools',\n  measurements: '@ohif/extension-cornerstone.panelModule.panelMeasurement',\n};\n\nconst segmentation = {\n  sopClassHandler: '@ohif/extension-cornerstone-dicom-seg.sopClassHandlerModule.dicom-seg',\n  viewport: '@ohif/extension-cornerstone-dicom-seg.viewportModule.dicom-seg',\n};\n\nconst dicomRT = {\n  viewport: '@ohif/extension-cornerstone-dicom-rt.viewportModule.dicom-rt',\n  sopClassHandler: '@ohif/extension-cornerstone-dicom-rt.sopClassHandlerModule.dicom-rt',\n};\n/**\n * Just two dependencies to be able to render a viewport with panels in order\n * to make sure that the mode is working.\n */\nconst extensionDependencies = {\n  '@ohif/extension-default': '^3.0.0',\n  '@ohif/extension-cornerstone': '^3.0.0',\n  '@ohif/extension-cornerstone-dicom-seg': '^3.0.0',\n  '@ohif/extension-cornerstone-dicom-rt': '^3.0.0',\n};\n\nfunction modeFactory({ modeConfiguration }) {\n  return {\n    /**\n     * Mode ID, which should be unique among modes used by the viewer. This ID\n     * is used to identify the mode in the viewer's state.\n     */\n    id,\n    routeName: 'segmentation',\n    /**\n     * Mode name, which is displayed in the viewer's UI in the workList, for the\n     * user to select the mode.\n     */\n    displayName: 'Segmentation',\n    /**\n     * Runs when the Mode Route is mounted to the DOM. Usually used to initialize\n     * Services and other resources.\n     */\n    onModeEnter: ({ servicesManager, extensionManager, commandsManager }: withAppTypes) => {\n      const { measurementService, toolbarService, toolGroupService, customizationService } =\n        servicesManager.services;\n\n      measurementService.clearMeasurements();\n\n      // Init Default and SR ToolGroups\n      initToolGroups(extensionManager, toolGroupService, commandsManager);\n\n      toolbarService.register(toolbarButtons);\n\n      toolbarService.updateSection(toolbarService.sections.primary, [\n        'WindowLevel',\n        'Pan',\n        'Zoom',\n        'TrackballRotate',\n        'Capture',\n        'Layout',\n        'Crosshairs',\n        'MoreTools',\n      ]);\n\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.topLeft, [\n        'orientationMenu',\n        'dataOverlayMenu',\n      ]);\n\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.bottomMiddle, [\n        'AdvancedRenderingControls',\n      ]);\n\n      toolbarService.updateSection('AdvancedRenderingControls', [\n        'windowLevelMenuEmbedded',\n        'voiManualControlMenu',\n        'Colorbar',\n        'opacityMenu',\n        'thresholdMenu',\n      ]);\n\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.topRight, [\n        'modalityLoadBadge',\n        'trackingStatus',\n        'navigationComponent',\n      ]);\n\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.bottomLeft, [\n        'windowLevelMenu',\n      ]);\n\n      toolbarService.updateSection('MoreTools', [\n        'Reset',\n        'rotate-right',\n        'flipHorizontal',\n        'ReferenceLines',\n        'ImageOverlayViewer',\n        'StackScroll',\n        'invert',\n        'Cine',\n        'Magnify',\n        'TagBrowser',\n      ]);\n\n      toolbarService.updateSection(toolbarService.sections.segmentationToolbox, [\n        'SegmentationUtilities',\n        'SegmentationTools',\n      ]);\n      toolbarService.updateSection('SegmentationUtilities', [\n        'LabelmapSlicePropagation',\n        'InterpolateLabelmap',\n        'SegmentBidirectional',\n      ]);\n      toolbarService.updateSection('SegmentationTools', [\n        'BrushTools',\n        'MarkerLabelmap',\n        'RegionSegmentPlus',\n        'Shapes',\n      ]);\n      toolbarService.updateSection('BrushTools', ['Brush', 'Eraser', 'Threshold']);\n    },\n    onModeExit: ({ servicesManager }: withAppTypes) => {\n      const {\n        toolGroupService,\n        syncGroupService,\n        segmentationService,\n        cornerstoneViewportService,\n        uiDialogService,\n        uiModalService,\n      } = servicesManager.services;\n\n      uiDialogService.hideAll();\n      uiModalService.hide();\n      toolGroupService.destroy();\n      syncGroupService.destroy();\n      segmentationService.destroy();\n      cornerstoneViewportService.destroy();\n    },\n    /** */\n    validationTags: {\n      study: [],\n      series: [],\n    },\n    /**\n     * A boolean return value that indicates whether the mode is valid for the\n     * modalities of the selected studies. Currently we don't have stack viewport\n     * segmentations and we should exclude them\n     */\n    isValidMode: ({ modalities }) => {\n      // Don't show the mode if the selected studies have only one modality\n      // that is not supported by the mode\n      const modalitiesArray = modalities.split('\\\\');\n      return {\n        valid:\n          modalitiesArray.length === 1\n            ? !['SM', 'ECG', 'OT', 'DOC'].includes(modalitiesArray[0])\n            : true,\n        description:\n          'The mode does not support studies that ONLY include the following modalities: SM, OT, DOC',\n      };\n    },\n    /**\n     * Mode Routes are used to define the mode's behavior. A list of Mode Route\n     * that includes the mode's path and the layout to be used. The layout will\n     * include the components that are used in the layout. For instance, if the\n     * default layoutTemplate is used (id: '@ohif/extension-default.layoutTemplateModule.viewerLayout')\n     * it will include the leftPanels, rightPanels, and viewports. However, if\n     * you define another layoutTemplate that includes a Footer for instance,\n     * you should provide the Footer component here too. Note: We use Strings\n     * to reference the component's ID as they are registered in the internal\n     * ExtensionManager. The template for the string is:\n     * `${extensionId}.{moduleType}.${componentId}`.\n     */\n    routes: [\n      {\n        path: 'template',\n        layoutTemplate: ({ location, servicesManager }) => {\n          return {\n            id: ohif.layout,\n            props: {\n              leftPanels: [ohif.leftPanel],\n              leftPanelResizable: true,\n              rightPanels: [cornerstone.panelTool],\n              rightPanelResizable: true,\n              // leftPanelClosed: true,\n              viewports: [\n                {\n                  namespace: cornerstone.viewport,\n                  displaySetsToDisplay: [ohif.sopClassHandler],\n                },\n                {\n                  namespace: segmentation.viewport,\n                  displaySetsToDisplay: [segmentation.sopClassHandler],\n                },\n                {\n                  namespace: dicomRT.viewport,\n                  displaySetsToDisplay: [dicomRT.sopClassHandler],\n                },\n              ],\n            },\n          };\n        },\n      },\n    ],\n    /** List of extensions that are used by the mode */\n    extensions: extensionDependencies,\n    /** HangingProtocol used by the mode */\n    // Commented out to just use the most applicable registered hanging protocol\n    // The example is used for a grid layout to specify that as a preferred layout\n    hangingProtocol: ['@ohif/mnGrid'],\n    /** SopClassHandlers used by the mode */\n    sopClassHandlers: [ohif.sopClassHandler, segmentation.sopClassHandler, dicomRT.sopClassHandler],\n  };\n}\n\nconst mode = {\n  id,\n  modeFactory,\n  extensionDependencies,\n};\n\nexport default mode;\n","const colours = {\n  'viewport-0': 'rgb(200, 0, 0)',\n  'viewport-1': 'rgb(200, 200, 0)',\n  'viewport-2': 'rgb(0, 200, 0)',\n};\n\nconst colorsByOrientation = {\n  axial: 'rgb(200, 0, 0)',\n  sagittal: 'rgb(200, 200, 0)',\n  coronal: 'rgb(0, 200, 0)',\n};\n\nfunction createTools(utilityModule) {\n  const { toolNames, Enums } = utilityModule.exports;\n  return {\n    active: [\n      { toolName: toolNames.WindowLevel, bindings: [{ mouseButton: Enums.MouseBindings.Primary }] },\n      { toolName: toolNames.Pan, bindings: [{ mouseButton: Enums.MouseBindings.Auxiliary }] },\n      {\n        toolName: toolNames.Zoom,\n        bindings: [{ mouseButton: Enums.MouseBindings.Secondary }, { numTouchPoints: 2 }],\n      },\n      {\n        toolName: toolNames.StackScroll,\n        bindings: [{ mouseButton: Enums.MouseBindings.Wheel }, { numTouchPoints: 3 }],\n      },\n    ],\n    passive: [\n      {\n        toolName: 'CircularBrush',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'FILL_INSIDE_CIRCLE',\n        },\n      },\n      {\n        toolName: toolNames.LabelmapSlicePropagation,\n      },\n      {\n        toolName: toolNames.MarkerLabelmap,\n      },\n      {\n        toolName: toolNames.RegionSegmentPlus,\n      },\n      {\n        toolName: 'CircularEraser',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'ERASE_INSIDE_CIRCLE',\n        },\n      },\n      {\n        toolName: 'SphereBrush',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'FILL_INSIDE_SPHERE',\n        },\n      },\n      {\n        toolName: 'SphereEraser',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'ERASE_INSIDE_SPHERE',\n        },\n      },\n      {\n        toolName: 'ThresholdCircularBrush',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'THRESHOLD_INSIDE_CIRCLE',\n        },\n      },\n      {\n        toolName: 'ThresholdSphereBrush',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'THRESHOLD_INSIDE_SPHERE',\n        },\n      },\n      {\n        toolName: 'ThresholdCircularBrushDynamic',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'THRESHOLD_INSIDE_CIRCLE',\n          threshold: {\n            isDynamic: true,\n            dynamicRadius: 3,\n          },\n        },\n      },\n      {\n        toolName: toolNames.SegmentBidirectional,\n      },\n      {\n        toolName: toolNames.SegmentSelect,\n      },\n      {\n        toolName: 'ThresholdSphereBrushDynamic',\n        parentTool: 'Brush',\n        configuration: {\n          activeStrategy: 'THRESHOLD_INSIDE_SPHERE',\n          threshold: {\n            isDynamic: true,\n            dynamicRadius: 3,\n          },\n        },\n      },\n      { toolName: toolNames.CircleScissors },\n      { toolName: toolNames.RectangleScissors },\n      { toolName: toolNames.SphereScissors },\n      { toolName: toolNames.StackScroll },\n      { toolName: toolNames.Magnify },\n      { toolName: toolNames.WindowLevelRegion },\n\n      { toolName: toolNames.UltrasoundDirectional },\n    ],\n    disabled: [\n      { toolName: toolNames.ReferenceLines },\n      { toolName: toolNames.AdvancedMagnify },\n      {\n        toolName: toolNames.SegmentLabel,\n        configuration: {\n          hoverTimeout: 1,\n        },\n      },\n    ],\n  };\n}\n\nfunction initDefaultToolGroup(extensionManager, toolGroupService, commandsManager, toolGroupId) {\n  const utilityModule = extensionManager.getModuleEntry(\n    '@ohif/extension-cornerstone.utilityModule.tools'\n  );\n  const tools = createTools(utilityModule);\n  toolGroupService.createToolGroupAndAddTools(toolGroupId, tools);\n}\n\nfunction initMPRToolGroup(extensionManager, toolGroupService, commandsManager) {\n  const utilityModule = extensionManager.getModuleEntry(\n    '@ohif/extension-cornerstone.utilityModule.tools'\n  );\n  const servicesManager = extensionManager._servicesManager;\n  const { cornerstoneViewportService } = servicesManager.services;\n  const tools = createTools(utilityModule);\n  tools.disabled.push(\n    {\n      toolName: utilityModule.exports.toolNames.Crosshairs,\n      configuration: {\n        viewportIndicators: true,\n        viewportIndicatorsConfig: {\n          circleRadius: 5,\n          xOffset: 0.95,\n          yOffset: 0.05,\n        },\n        disableOnPassive: true,\n        autoPan: {\n          enabled: false,\n          panSize: 10,\n        },\n        getReferenceLineColor: viewportId => {\n          const viewportInfo = cornerstoneViewportService.getViewportInfo(viewportId);\n          const viewportOptions = viewportInfo?.viewportOptions;\n          if (viewportOptions) {\n            return (\n              colours[viewportOptions.id] ||\n              colorsByOrientation[viewportOptions.orientation] ||\n              '#0c0'\n            );\n          } else {\n            console.warn('missing viewport?', viewportId);\n            return '#0c0';\n          }\n        },\n      },\n    },\n    { toolName: utilityModule.exports.toolNames.ReferenceLines }\n  );\n  toolGroupService.createToolGroupAndAddTools('mpr', tools);\n}\n\nfunction initVolume3DToolGroup(extensionManager, toolGroupService) {\n  const utilityModule = extensionManager.getModuleEntry(\n    '@ohif/extension-cornerstone.utilityModule.tools'\n  );\n\n  const { toolNames, Enums } = utilityModule.exports;\n\n  const tools = {\n    active: [\n      {\n        toolName: toolNames.TrackballRotateTool,\n        bindings: [{ mouseButton: Enums.MouseBindings.Primary }],\n      },\n      {\n        toolName: toolNames.Zoom,\n        bindings: [{ mouseButton: Enums.MouseBindings.Secondary }, { numTouchPoints: 2 }],\n      },\n      {\n        toolName: toolNames.Pan,\n        bindings: [{ mouseButton: Enums.MouseBindings.Auxiliary }],\n      },\n    ],\n  };\n\n  toolGroupService.createToolGroupAndAddTools('volume3d', tools);\n}\n\nfunction initToolGroups(extensionManager, toolGroupService, commandsManager) {\n  initDefaultToolGroup(extensionManager, toolGroupService, commandsManager, 'default');\n  initMPRToolGroup(extensionManager, toolGroupService, commandsManager);\n  initVolume3DToolGroup(extensionManager, toolGroupService);\n}\n\nexport default initToolGroups;\n","import type { Button } from '@ohif/core/types';\nimport { ViewportGridService } from '@ohif/core';\n\nconst setToolActiveToolbar = {\n  commandName: 'setToolActiveToolbar',\n  commandOptions: {\n    toolGroupIds: ['default', 'mpr', 'SRToolGroup', 'volume3d'],\n  },\n};\n\nconst callbacks = (toolName: string) => [\n  {\n    commandName: 'setViewportForToolConfiguration',\n    commandOptions: {\n      toolName,\n    },\n  },\n];\n\nconst toolbarButtons: Button[] = [\n  {\n    id: 'AdvancedRenderingControls',\n    uiType: 'ohif.advancedRenderingControls',\n    props: {\n      buttonSection: true,\n    },\n  },\n  {\n    id: 'modalityLoadBadge',\n    uiType: 'ohif.modalityLoadBadge',\n    props: {\n      icon: 'Status',\n      label: 'Status',\n      tooltip: 'Status',\n      evaluate: {\n        name: 'evaluate.modalityLoadBadge',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'navigationComponent',\n    uiType: 'ohif.navigationComponent',\n    props: {\n      icon: 'Navigation',\n      label: 'Navigation',\n      tooltip: 'Navigate between segments/measurements and manage their visibility',\n      evaluate: {\n        name: 'evaluate.navigationComponent',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'trackingStatus',\n    uiType: 'ohif.trackingStatus',\n    props: {\n      icon: 'TrackingStatus',\n      label: 'Tracking Status',\n      tooltip: 'View and manage tracking status of measurements and annotations',\n      evaluate: {\n        name: 'evaluate.trackingStatus',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'dataOverlayMenu',\n    uiType: 'ohif.dataOverlayMenu',\n    props: {\n      icon: 'ViewportViews',\n      label: 'Data Overlay',\n      tooltip: 'Configure data overlay options and manage foreground/background display sets',\n      evaluate: 'evaluate.dataOverlayMenu',\n    },\n  },\n  {\n    id: 'orientationMenu',\n    uiType: 'ohif.orientationMenu',\n    props: {\n      icon: 'OrientationSwitch',\n      label: 'Orientation',\n      tooltip: 'Change viewport orientation between axial, sagittal, coronal and reformat planes',\n      evaluate: {\n        name: 'evaluate.orientationMenu',\n        // hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'windowLevelMenuEmbedded',\n    uiType: 'ohif.windowLevelMenuEmbedded',\n    props: {\n      icon: 'WindowLevel',\n      label: 'Window Level',\n      tooltip: 'Adjust window/level presets and customize image contrast settings',\n      evaluate: {\n        name: 'evaluate.windowLevelMenuEmbedded',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'windowLevelMenu',\n    uiType: 'ohif.windowLevelMenu',\n    props: {\n      icon: 'WindowLevel',\n      label: 'Window Level',\n      tooltip: 'Adjust window/level presets and customize image contrast settings',\n      evaluate: 'evaluate.windowLevelMenu',\n    },\n  },\n  {\n    id: 'voiManualControlMenu',\n    uiType: 'ohif.voiManualControlMenu',\n    props: {\n      icon: 'WindowLevelAdvanced',\n      label: 'Advanced Window Level',\n      tooltip: 'Advanced window/level settings with manual controls and presets',\n      evaluate: 'evaluate.voiManualControlMenu',\n    },\n  },\n  {\n    id: 'thresholdMenu',\n    uiType: 'ohif.thresholdMenu',\n    props: {\n      icon: 'Threshold',\n      label: 'Threshold',\n      tooltip: 'Image threshold settings',\n      evaluate: {\n        name: 'evaluate.thresholdMenu',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'opacityMenu',\n    uiType: 'ohif.opacityMenu',\n    props: {\n      icon: 'Opacity',\n      label: 'Opacity',\n      tooltip: 'Image opacity settings',\n      evaluate: {\n        name: 'evaluate.opacityMenu',\n        hideWhenDisabled: true,\n      },\n    },\n  },\n  {\n    id: 'Colorbar',\n    uiType: 'ohif.colorbar',\n    props: {\n      type: 'tool',\n      label: 'Colorbar',\n    },\n  },\n  // sections\n  {\n    id: 'MoreTools',\n    uiType: 'ohif.toolButtonList',\n    props: {\n      buttonSection: true,\n    },\n  },\n  {\n    id: 'BrushTools',\n    uiType: 'ohif.toolBoxButtonGroup',\n    props: {\n      buttonSection: true,\n    },\n  },\n  // Section containers for the nested toolbox\n  {\n    id: 'SegmentationUtilities',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      buttonSection: true,\n    },\n  },\n  {\n    id: 'SegmentationTools',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      buttonSection: true,\n    },\n  },\n  // tool defs\n  {\n    id: 'Zoom',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-zoom',\n      label: 'Zoom',\n      commands: setToolActiveToolbar,\n      evaluate: 'evaluate.cornerstoneTool',\n    },\n  },\n  {\n    id: 'WindowLevel',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-window-level',\n      label: 'Window Level',\n      commands: setToolActiveToolbar,\n      evaluate: 'evaluate.cornerstoneTool',\n    },\n  },\n  {\n    id: 'Pan',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-move',\n      label: 'Pan',\n      commands: setToolActiveToolbar,\n      evaluate: 'evaluate.cornerstoneTool',\n    },\n  },\n  {\n    id: 'TrackballRotate',\n    uiType: 'ohif.toolButton',\n    props: {\n      type: 'tool',\n      icon: 'tool-3d-rotate',\n      label: '3D Rotate',\n      commands: setToolActiveToolbar,\n      evaluate: {\n        name: 'evaluate.cornerstoneTool',\n        disabledText: 'Select a 3D viewport to enable this tool',\n      },\n    },\n  },\n  {\n    id: 'Capture',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-capture',\n      label: 'Capture',\n      commands: 'showDownloadViewportModal',\n      evaluate: [\n        'evaluate.action',\n        {\n          name: 'evaluate.viewport.supported',\n          unsupportedViewportTypes: ['video', 'wholeSlide'],\n        },\n      ],\n    },\n  },\n  {\n    id: 'Layout',\n    uiType: 'ohif.layoutSelector',\n    props: {\n      rows: 3,\n      columns: 4,\n      evaluate: 'evaluate.action',\n      commands: 'setViewportGridLayout',\n    },\n  },\n  {\n    id: 'Crosshairs',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-crosshair',\n      label: 'Crosshairs',\n      commands: {\n        commandName: 'setToolActiveToolbar',\n        commandOptions: {\n          toolGroupIds: ['mpr'],\n        },\n      },\n      evaluate: {\n        name: 'evaluate.cornerstoneTool',\n        disabledText: 'Select an MPR viewport to enable this tool',\n      },\n    },\n  },\n  {\n    id: 'Reset',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-reset',\n      label: 'Reset View',\n      tooltip: 'Reset View',\n      commands: 'resetViewport',\n      evaluate: 'evaluate.action',\n    },\n  },\n  {\n    id: 'rotate-right',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-rotate-right',\n      label: 'Rotate Right',\n      tooltip: 'Rotate +90',\n      commands: 'rotateViewportCW',\n      evaluate: 'evaluate.action',\n    },\n  },\n  {\n    id: 'flipHorizontal',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-flip-horizontal',\n      label: 'Flip Horizontal',\n      tooltip: 'Flip Horizontally',\n      commands: 'flipViewportHorizontal',\n      evaluate: [\n        'evaluate.viewportProperties.toggle',\n        {\n          name: 'evaluate.viewport.supported',\n          unsupportedViewportTypes: ['volume3d'],\n        },\n      ],\n    },\n  },\n  {\n    id: 'ReferenceLines',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-referenceLines',\n      label: 'Reference Lines',\n      tooltip: 'Show Reference Lines',\n      commands: 'toggleEnabledDisabledToolbar',\n      evaluate: 'evaluate.cornerstoneTool.toggle',\n    },\n  },\n  {\n    id: 'ImageOverlayViewer',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'toggle-dicom-overlay',\n      label: 'Image Overlay',\n      tooltip: 'Toggle Image Overlay',\n      commands: 'toggleEnabledDisabledToolbar',\n      evaluate: 'evaluate.cornerstoneTool.toggle',\n    },\n  },\n  {\n    id: 'StackScroll',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-stack-scroll',\n      label: 'Stack Scroll',\n      tooltip: 'Stack Scroll',\n      commands: setToolActiveToolbar,\n      evaluate: 'evaluate.cornerstoneTool',\n    },\n  },\n  {\n    id: 'invert',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-invert',\n      label: 'Invert',\n      tooltip: 'Invert Colors',\n      commands: 'invertViewport',\n      evaluate: 'evaluate.viewportProperties.toggle',\n    },\n  },\n  {\n    id: 'Cine',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-cine',\n      label: 'Cine',\n      tooltip: 'Cine',\n      commands: 'toggleCine',\n      evaluate: [\n        'evaluate.cine',\n        {\n          name: 'evaluate.viewport.supported',\n          unsupportedViewportTypes: ['volume3d'],\n        },\n      ],\n    },\n  },\n  {\n    id: 'Magnify',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'tool-magnify',\n      label: 'Zoom-in',\n      tooltip: 'Zoom-in',\n      commands: setToolActiveToolbar,\n      evaluate: 'evaluate.cornerstoneTool',\n    },\n  },\n  {\n    id: 'TagBrowser',\n    uiType: 'ohif.toolButton',\n    props: {\n      icon: 'dicom-tag-browser',\n      label: 'Dicom Tag Browser',\n      tooltip: 'Dicom Tag Browser',\n      commands: 'openDICOMTagViewer',\n    },\n  },\n\n  {\n    id: 'Brush',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-brush',\n      label: 'Brush',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        toolNames: ['CircularBrush', 'SphereBrush'],\n        disabledText: 'Create new segmentation to enable this tool.',\n      },\n      options: [\n        {\n          name: 'Radius (mm)',\n          id: 'brush-radius',\n          type: 'range',\n          min: 0.5,\n          max: 99.5,\n          step: 0.5,\n          value: 25,\n          commands: {\n            commandName: 'setBrushSize',\n            commandOptions: { toolNames: ['CircularBrush', 'SphereBrush'] },\n          },\n        },\n        {\n          name: 'Shape',\n          type: 'radio',\n          id: 'brush-mode',\n          value: 'CircularBrush',\n          values: [\n            { value: 'CircularBrush', label: 'Circle' },\n            { value: 'SphereBrush', label: 'Sphere' },\n          ],\n          commands: 'setToolActiveToolbar',\n        },\n      ],\n    },\n  },\n  {\n    id: 'InterpolateLabelmap',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-interpolation',\n      label: 'Interpolate Labelmap',\n      tooltip:\n        'Automatically fill in missing slices between drawn segments. Use brush or threshold tools on at least two slices, then click to interpolate across slices. Works in any direction. Volume must be reconstructable.',\n      evaluate: [\n        'evaluate.cornerstone.segmentation',\n        {\n          name: 'evaluate.displaySetIsReconstructable',\n          disabledText: 'The current viewport cannot handle interpolation.',\n        },\n      ],\n      commands: 'interpolateLabelmap',\n    },\n  },\n  {\n    id: 'SegmentBidirectional',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-bidirectional-segment',\n      label: 'Segment Bidirectional',\n      tooltip:\n        'Automatically detects the largest length and width across slices for the selected segment and displays a bidirectional measurement.',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        disabledText: 'Create new segmentation to enable this tool.',\n      },\n      commands: 'runSegmentBidirectional',\n    },\n  },\n  {\n    id: 'RegionSegmentPlus',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-click-segment',\n      label: 'One Click Segment',\n      tooltip:\n        'Detects segmentable regions with one click. Hover for visual feedbackâ€”click when a plus sign appears to auto-segment the lesion.',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        toolNames: ['RegionSegmentPlus'],\n        disabledText: 'Create new segmentation to enable this tool.',\n      },\n      commands: 'setToolActiveToolbar',\n    },\n  },\n  {\n    id: 'LabelmapSlicePropagation',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-labelmap-slice-propagation',\n      label: 'Labelmap Assist',\n      tooltip:\n        'Toggle AI assistance for segmenting nearby slices. After drawing on a slice, scroll to preview predictions. Press Enter to accept or Esc to skip.',\n      evaluate: [\n        'evaluate.cornerstoneTool.toggle',\n        {\n          name: 'evaluate.cornerstone.hasSegmentation',\n        },\n      ],\n      listeners: {\n        [ViewportGridService.EVENTS.ACTIVE_VIEWPORT_ID_CHANGED]: callbacks(\n          'LabelmapSlicePropagation'\n        ),\n        [ViewportGridService.EVENTS.VIEWPORTS_READY]: callbacks('LabelmapSlicePropagation'),\n      },\n      commands: 'toggleEnabledDisabledToolbar',\n    },\n  },\n  {\n    id: 'MarkerLabelmap',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-marker-labelmap',\n      label: 'Marker Guided Labelmap',\n      tooltip:\n        'Use include/exclude markers to guide AI (SAM) segmentation. Click to place markers, Enter to accept results, Esc to reject, and N to go to the next slice while keeping markers.',\n      evaluate: [\n        {\n          name: 'evaluate.cornerstone.segmentation',\n          toolNames: ['MarkerLabelmap', 'MarkerInclude', 'MarkerExclude'],\n        },\n      ],\n      commands: 'setToolActiveToolbar',\n      listeners: {\n        [ViewportGridService.EVENTS.ACTIVE_VIEWPORT_ID_CHANGED]: callbacks('MarkerLabelmap'),\n        [ViewportGridService.EVENTS.VIEWPORTS_READY]: callbacks('MarkerLabelmap'),\n      },\n      options: [\n        {\n          name: 'Marker Mode',\n          type: 'radio',\n          id: 'marker-mode',\n          value: 'markerInclude',\n          values: [\n            { value: 'markerInclude', label: 'Include' },\n            { value: 'markerExclude', label: 'Exclude' },\n          ],\n          commands: ({ commandsManager, options }) => {\n            const markerModeOption = options.find(option => option.id === 'marker-mode');\n            if (markerModeOption.value === 'markerInclude') {\n              commandsManager.run('setToolActive', {\n                toolName: 'MarkerInclude',\n              });\n            } else {\n              commandsManager.run('setToolActive', {\n                toolName: 'MarkerExclude',\n              });\n            }\n          },\n        },\n        {\n          name: 'Clear Markers',\n          type: 'button',\n          id: 'clear-markers',\n          commands: 'clearMarkersForMarkerLabelmap',\n        },\n      ],\n    },\n  },\n  {\n    id: 'Eraser',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-eraser',\n      label: 'Eraser',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        toolNames: ['CircularEraser', 'SphereEraser'],\n      },\n      options: [\n        {\n          name: 'Radius (mm)',\n          id: 'eraser-radius',\n          type: 'range',\n          min: 0.5,\n          max: 99.5,\n          step: 0.5,\n          value: 25,\n          commands: {\n            commandName: 'setBrushSize',\n            commandOptions: { toolNames: ['CircularEraser', 'SphereEraser'] },\n          },\n        },\n        {\n          name: 'Shape',\n          type: 'radio',\n          id: 'eraser-mode',\n          value: 'CircularEraser',\n          values: [\n            { value: 'CircularEraser', label: 'Circle' },\n            { value: 'SphereEraser', label: 'Sphere' },\n          ],\n          commands: 'setToolActiveToolbar',\n        },\n      ],\n    },\n  },\n  {\n    id: 'Threshold',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-threshold',\n      label: 'Threshold Tool',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        toolNames: [\n          'ThresholdCircularBrush',\n          'ThresholdSphereBrush',\n          'ThresholdCircularBrushDynamic',\n          'ThresholdSphereBrushDynamic',\n        ],\n      },\n      options: [\n        {\n          name: 'Radius (mm)',\n          id: 'threshold-radius',\n          type: 'range',\n          min: 0.5,\n          max: 99.5,\n          step: 0.5,\n          value: 25,\n          commands: {\n            commandName: 'setBrushSize',\n            commandOptions: {\n              toolNames: [\n                'ThresholdCircularBrush',\n                'ThresholdSphereBrush',\n                'ThresholdCircularBrushDynamic',\n                'ThresholdSphereBrushDynamic',\n              ],\n            },\n          },\n        },\n        {\n          name: 'Shape',\n          type: 'radio',\n          id: 'threshold-shape',\n          value: 'ThresholdCircularBrush',\n          values: [\n            { value: 'ThresholdCircularBrush', label: 'Circle' },\n            { value: 'ThresholdSphereBrush', label: 'Sphere' },\n          ],\n          commands: ({ value, commandsManager, options }) => {\n            const optionsDynamic = options.find(option => option.id === 'dynamic-mode');\n\n            if (optionsDynamic.value === 'ThresholdDynamic') {\n              commandsManager.run('setToolActive', {\n                toolName:\n                  value === 'ThresholdCircularBrush'\n                    ? 'ThresholdCircularBrushDynamic'\n                    : 'ThresholdSphereBrushDynamic',\n              });\n            } else {\n              commandsManager.run('setToolActive', {\n                toolName: value,\n              });\n            }\n          },\n        },\n        {\n          name: 'Threshold',\n          type: 'radio',\n          id: 'dynamic-mode',\n          value: 'ThresholdDynamic',\n          values: [\n            { value: 'ThresholdDynamic', label: 'Dynamic' },\n            { value: 'ThresholdRange', label: 'Range' },\n          ],\n          commands: ({ value, commandsManager, options }) => {\n            const thresholdRangeOption = options.find(option => option.id === 'threshold-shape');\n\n            if (value === 'ThresholdDynamic') {\n              commandsManager.run('setToolActiveToolbar', {\n                toolName:\n                  thresholdRangeOption.value === 'ThresholdCircularBrush'\n                    ? 'ThresholdCircularBrushDynamic'\n                    : 'ThresholdSphereBrushDynamic',\n              });\n            } else {\n              commandsManager.run('setToolActiveToolbar', {\n                toolName: thresholdRangeOption.value,\n              });\n\n              const thresholdRangeValue = options.find(\n                option => option.id === 'threshold-range'\n              ).value;\n\n              commandsManager.run('setThresholdRange', {\n                toolNames: ['ThresholdCircularBrush', 'ThresholdSphereBrush'],\n                value: thresholdRangeValue,\n              });\n            }\n          },\n        },\n        {\n          name: 'ThresholdRange',\n          type: 'double-range',\n          id: 'threshold-range',\n          min: -1000,\n          max: 1000,\n          step: 1,\n          value: [50, 600],\n          condition: ({ options }) =>\n            options.find(option => option.id === 'dynamic-mode').value === 'ThresholdRange',\n          commands: {\n            commandName: 'setThresholdRange',\n            commandOptions: {\n              toolNames: ['ThresholdCircularBrush', 'ThresholdSphereBrush'],\n            },\n          },\n        },\n      ],\n    },\n  },\n  {\n    id: 'Shapes',\n    uiType: 'ohif.toolBoxButton',\n    props: {\n      icon: 'icon-tool-shape',\n      label: 'Shapes',\n      evaluate: {\n        name: 'evaluate.cornerstone.segmentation',\n        toolNames: ['CircleScissor', 'SphereScissor', 'RectangleScissor'],\n        disabledText: 'Create new segmentation to enable shapes tool.',\n      },\n      options: [\n        {\n          name: 'Shape',\n          type: 'radio',\n          value: 'CircleScissor',\n          id: 'shape-mode',\n          values: [\n            { value: 'CircleScissor', label: 'Circle' },\n            { value: 'SphereScissor', label: 'Sphere' },\n            { value: 'RectangleScissor', label: 'Rectangle' },\n          ],\n          commands: 'setToolActiveToolbar',\n        },\n      ],\n    },\n  },\n];\n\nexport default toolbarButtons;\n"],"names":[],"sourceRoot":""}